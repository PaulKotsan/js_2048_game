!function(){function t(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}new(function(){var e;function n(){var e=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,n),t(this,"handleInput",function(t){if("playing"===e.state){var n=t.key.toLowerCase();(function(){switch(n){case"a":return e.moveLeft();case"d":return e.moveRight();case"w":return e.moveUp();case"s":return e.moveDown();default:return!1}})()&&(e.generateNewCells(),e.getScore(),e.handleGameResolvment(),e.countMoves+=1,e.lastMoveDirection=n)}}),t(this,"cheats",function(){if("playing"===e.state&&!document.querySelector(".cheat-menu-container")){var t=document.createElement("form");t.className="cheat-menu-container";var n=document.createElement("p");n.innerHTML='I used this to test <span style="color: green;">Win</span>/<span style="color: red;">Lose</span> system.<br>You used this because you are a <span style="color: red;">cheater</span>.<br>Its an open source game so you can add infinite money or whatever...<br>Add animations if you want, im not doing this...';var o=document.createElement("label");o.textContent="Win option: ";var a=document.createElement("select");a.className="cheat-menu__input";var s=document.createElement("option");s.text="Auto Win";var r=document.createElement("option");r.text="Auto Lose",a.add(s),a.add(r),o.appendChild(a);var i=document.createElement("button");i.className="apply-cheat-button",i.type="button",i.textContent="Apply",t.appendChild(o),t.appendChild(i),t.appendChild(n),document.body.appendChild(t),i.addEventListener("click",function(){"Auto Win"===a.value?(e.boardLayout.forEach(function(t,n){t.forEach(function(t,o){e.boardLayout[n][o]=2048})}),e.updateBoardDisplay()):"Auto Lose"===a.value&&(e.boardLayout.forEach(function(t,n){t.forEach(function(t,o){e.boardLayout[n][o]=0})}),e.updateBoardDisplay(),e.showLoseMessage()),t.remove()})}}),this.boardLayout=o,this.gameField=document.querySelector(".game-field"),this.fieldRows=Array.from(this.gameField.querySelectorAll("tr")),this.emptyCells=[],this.startMessage=document.querySelector(".message-start"),this.loseMessage=document.querySelector(".message-lose"),this.winMessage=document.querySelector(".message-win"),this.totalScoreMessage=document.querySelector(".message-tatal__score"),this.controlButton=document.querySelector(".button"),this.cheatButton=document.querySelector(".cheat-button"),this.state="idle",this.status="process",this.canMove=!0,this.oppositeMoveDirections={left:"right",right:"left",up:"down",down:"up"},this.lastMoveDirection="",this.countMoves=0}return e=[{key:"moveLeft",value:function(){var t=this;this.canMove=!1;var e=!1;return this.boardLayout.forEach(function(n){for(var o=0;o<n.length-1;o++)0!==n[o]&&n[o]===n[o+1]&&(n[o]*=2,n[o+1]=0,t.canMove=!0,e=!0);for(var a=0;a<n.length;a++)if(0===n[a]){for(var s=a+1;s<n.length;s++)if(0!==n[s]){n[a]=n[s],n[s]=0,t.canMove=!0,e=!0;break}}}),this.lastMoveDirection&&this.lastMoveDirection===this.oppositeMoveDirections.left&&(this.canMove=!0),this.lastMoveDirection="left",this.updateBoardDisplay(),e}},{key:"moveRight",value:function(){var t=this;this.canMove=!1;var e=!1;return this.boardLayout.forEach(function(n){for(var o=n.length-2;o>=0;o--)0!==n[o]&&n[o]===n[o+1]&&(n[o+1]*=2,n[o]=0,t.canMove=!0,e=!0);for(var a=n.length-1;a>=0;a--)if(0===n[a]){for(var s=a-1;s>=0;s--)if(0!==n[s]){n[a]=n[s],n[s]=0,t.canMove=!0,e=!0;break}}}),this.lastMoveDirection&&this.lastMoveDirection===this.oppositeMoveDirections.right&&(this.canMove=!0),this.lastMoveDirection="left",this.updateBoardDisplay(),e}},{key:"moveUp",value:function(){var t=this,e=!1,n=JSON.parse(JSON.stringify(this.boardLayout));return this.boardLayout[0].map(function(e,n){return t.boardLayout.map(function(t){return t[n]})}).forEach(function(o,a){for(var s=o.filter(function(t){return 0!==t}),r=[],i=0;i<s.length;i++)s[i]===s[i+1]?(r.push(2*s[i]),e=!0,i++):r.push(s[i]);for(;r.length<o.length;)r.push(0);r.forEach(function(e,n){t.boardLayout[n][a]=e}),t.areBoardsEqual(n,t.boardLayout)||(e=!0)}),e}},{key:"moveDown",value:function(){var t=this,e=!1,n=JSON.parse(JSON.stringify(this.boardLayout));return this.boardLayout[0].map(function(e,n){return t.boardLayout.map(function(t){return t[n]})}).forEach(function(o,a){for(var s=o.filter(function(t){return 0!==t}).reverse(),r=[],i=0;i<s.length;i++)s[i]===s[i+1]?(r.push(2*s[i]),e=!0,i++):r.push(s[i]);for(;r.length<o.length;)r.push(0);r.reverse(),r.forEach(function(e,n){t.boardLayout[n][a]=e}),t.areBoardsEqual(n,t.boardLayout)||(e=!0)}),e}},{key:"getScore",value:function(){var t=document.querySelector(".game-score"),e=[];return this.boardLayout.forEach(function(t){var n=t.reduce(function(t,e){return t+e},0);e.push(n)}),t.textContent=e.reduce(function(t,e){return t+e},0),t.textContent}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){var t=this,e=function(){"idle"===t.getState()?(t.startGame(),t.state="playing",t.controlButton.className="button restart",t.controlButton.textContent="Restart",t.startMessage.classList.add("hidden")):("playing"===t.getState()||"win"===t.getState()||"lose"===t.getState())&&t.restart()};this.controlButton.removeEventListener("click",this.controlHandler),this.controlButton.addEventListener("click",e),this.controlHandler=e}},{key:"restart",value:function(){this.state="idle",this.status="process",this.startMessage.classList.remove("hidden"),this.winMessage.classList.add("hidden"),this.loseMessage.classList.add("hidden"),this.totalScoreMessage.classList.add("hidden"),this.controlButton.className="button start",this.controlButton.textContent="Start",this.boardLayout=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.updateBoardDisplay()}},{key:"startGame",value:function(){this.state="playing",this.controlButton.className="button restart",this.controlButton.textContent="Restart",this.getScore(),this.initPLayerInput(),this.initCheats(),this.generateNewCells(),this.generateNewCells()}},{key:"initPLayerInput",value:function(){this.resetInput(),"playing"===this.state&&this.bindPlayerInput()}},{key:"initCheats",value:function(){this.resetCheats(),"playing"===this.state&&this.bindCheats()}},{key:"bindPlayerInput",value:function(){document.addEventListener("keydown",this.handleInput)}},{key:"bindCheats",value:function(){this.cheatButton.addEventListener("click",this.cheats)}},{key:"resetInput",value:function(){document.removeEventListener("keydown",this.handleInput)}},{key:"resetCheats",value:function(){this.cheatButton.removeEventListener("click",this.cheats)}},{key:"generateNewCells",value:function(){var t=this,e=.9>Math.random()?2:4;if(this.emptyCells=[],this.boardLayout.forEach(function(e,n){e.forEach(function(e,o){0===e&&t.emptyCells.push({rowIndex:n,colIndex:o})})}),this.emptyCells.length>0){var n=Math.floor(Math.random()*this.emptyCells.length),o=this.emptyCells[n],a=o.rowIndex,s=o.colIndex;this.boardLayout[a][s]=e,this.updateBoardDisplay()}}},{key:"updateBoardDisplay",value:function(){var t=this;this.fieldRows.forEach(function(e,n){Array.from(e.children).forEach(function(e,o){var a=t.boardLayout[n][o];e.textContent=0!==a?a:"",e.className="field-cell field-cell--".concat(a),2048===a&&(t.status="win",t.state="win",t.totalScoreMessage.innerHTML="Your total score is: ".concat(t.getScore(),"<br>")+"Moves made "+t.countMoves,t.totalScoreMessage.classList.remove("hidden"),t.showWinMessage())})})}},{key:"areBoardsEqual",value:function(t,e){return JSON.stringify(t)===JSON.stringify(e)}},{key:"showLoseMessage",value:function(){this.loseMessage.classList.remove("hidden")}},{key:"showWinMessage",value:function(){this.winMessage.classList.remove("hidden")}},{key:"handleGameResolvment",value:function(){var t=this;new Promise(function(e){t.boardLayout.some(function(e,n){return e.some(function(o,a){return a<e.length-1&&e[a]===e[a+1]||n<t.boardLayout.length-1&&t.boardLayout[n][a]===t.boardLayout[n+1][a]})})||e("lose")}).then(function(){t.status="lose",t.state="lose",t.totalScoreMessage.innerHTML="Your total score is: ".concat(t.getScore(),"<br>")+"Moves made "+t.countMoves,t.totalScoreMessage.classList.remove("hidden"),t.showLoseMessage()})}}],function(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}(n.prototype,e),n}())().start()}();
//# sourceMappingURL=index.572e9113.js.map
